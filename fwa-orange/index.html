<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>勉強タイマー</title>
  <style>
    /* ========================================
       基本設定
       ======================================== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #ffe8cc 0%, #ffd4a3 50%, #ffcb8e 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    /* ========================================
       メインコンテナ
       ======================================== */
    .container {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 40px;
      padding: 50px 45px;
      max-width: 600px;
      width: 100%;
      box-shadow: 0 25px 50px rgba(255, 150, 50, 0.15);
      border: 3px solid rgba(255, 255, 255, 0.8);
    }

    .title {
      text-align: center;
      font-size: 28px;
      font-weight: 700;
      background: linear-gradient(135deg, #ffb366, #ff9944);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 35px;
      letter-spacing: 1px;
    }

    /* ========================================
       プリセットボタン
       ======================================== */
    .presets {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-bottom: 30px;
    }

    .preset-btn {
      background: linear-gradient(135deg, #fff5eb 0%, #ffe8d6 100%);
      border: 2px solid #ffd4a3;
      border-radius: 20px;
      padding: 22px 15px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      text-align: center;
      box-shadow: 0 4px 15px rgba(255, 150, 50, 0.08);
    }

    .preset-btn:hover {
      background: linear-gradient(135deg, #ffeddb 0%, #ffddc4 100%);
      transform: translateY(-4px);
      box-shadow: 0 8px 25px rgba(255, 150, 50, 0.15);
      border-color: #ffb366;
    }

    .preset-btn.active {
      background: linear-gradient(135deg, #ffd4a3 0%, #ffb366 100%);
      border-color: #ff9944;
      color: white;
      transform: scale(1.05);
      box-shadow: 0 8px 25px rgba(255, 150, 50, 0.25);
    }

    .preset-title {
      font-size: 17px;
      font-weight: 700;
      margin-bottom: 6px;
      color: #8b6239;
    }

    .preset-btn.active .preset-title {
      color: white;
    }

    .preset-time {
      font-size: 13px;
      opacity: 0.75;
      color: #a07856;
      font-weight: 500;
    }

    .preset-btn.active .preset-time {
      color: rgba(255, 255, 255, 0.9);
    }

    /* ========================================
       カスタム設定エリア
       ======================================== */
    .custom-settings {
      background: linear-gradient(135deg, #fff9f0 0%, #fff0e1 100%);
      border-radius: 25px;
      padding: 25px;
      margin-bottom: 30px;
      display: none;
      border: 2px solid #ffe8d6;
      box-shadow: inset 0 2px 8px rgba(255, 150, 50, 0.05);
    }

    .custom-settings.show {
      display: block;
    }

    .custom-title {
      font-size: 15px;
      font-weight: 700;
      color: #8b6239;
      margin-bottom: 18px;
      text-align: center;
      letter-spacing: 0.5px;
    }

    .input-row {
      display: flex;
      gap: 15px;
      justify-content: center;
      align-items: center;
      margin-bottom: 18px;
    }

    .input-group {
      text-align: center;
    }

    .input-group label {
      display: block;
      font-size: 13px;
      font-weight: 600;
      color: #8b6239;
      margin-bottom: 8px;
      letter-spacing: 0.5px;
    }

    .input-group input {
      width: 85px;
      padding: 12px;
      border: 2px solid #ffd4a3;
      border-radius: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: 700;
      background: white;
      color: #8b6239;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(255, 150, 50, 0.08);
    }

    .input-group input:focus {
      outline: none;
      border-color: #ffb366;
      box-shadow: 0 4px 15px rgba(255, 150, 50, 0.15);
      transform: scale(1.05);
    }

    /* ========================================
       タイマー表示
       ======================================== */
    .timer-display {
      text-align: center;
      margin: 45px 0;
      padding: 35px;
      background: linear-gradient(135deg, #fff9f0 0%, #fff0e1 100%);
      border-radius: 30px;
      border: 2px solid #ffe8d6;
      box-shadow: 0 8px 25px rgba(255, 150, 50, 0.1);
    }

    .timer-text {
      font-size: 80px;
      font-weight: 800;
      background: linear-gradient(135deg, #ffb366, #ff9944);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-variant-numeric: tabular-nums;
      line-height: 1;
      text-shadow: 0 2px 15px rgba(255, 150, 50, 0.1);
    }

    .timer-label {
      font-size: 16px;
      color: #a07856;
      margin-top: 12px;
      font-weight: 600;
      letter-spacing: 1px;
    }

    /* ========================================
       プログレスバー
       ======================================== */
    .progress-container {
      background: linear-gradient(135deg, #fff5eb 0%, #ffe8d6 100%);
      border-radius: 25px;
      height: 18px;
      margin: 30px 0;
      overflow: hidden;
      border: 2px solid #ffe8d6;
      box-shadow: inset 0 2px 8px rgba(255, 150, 50, 0.08);
    }

    .progress-bar {
      background: linear-gradient(90deg, #ffd4a3, #ffb366, #ff9944);
      height: 100%;
      width: 100%;
      transition: width 0.3s ease;
      border-radius: 25px;
      box-shadow: 0 0 15px rgba(255, 150, 50, 0.3);
    }

    /* ========================================
       コントロールボタン
       ======================================== */
    .controls {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

    .btn {
      padding: 16px 40px;
      border: none;
      border-radius: 20px;
      font-size: 17px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      min-width: 140px;
      letter-spacing: 0.5px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }

    .btn:active {
      transform: translateY(-1px);
    }

    .btn:focus {
      outline: 3px solid rgba(255, 180, 102, 0.4);
      outline-offset: 2px;
    }

    .btn-start {
      background: linear-gradient(135deg, #a8e6a1 0%, #76d672 100%);
      color: white;
      border: 2px solid rgba(255, 255, 255, 0.3);
    }

    .btn-start:hover {
      background: linear-gradient(135deg, #95db8e 0%, #63cc5f 100%);
    }

    .btn-pause {
      background: linear-gradient(135deg, #ffd4a3 0%, #ffb366 100%);
      color: white;
      border: 2px solid rgba(255, 255, 255, 0.3);
    }

    .btn-pause:hover {
      background: linear-gradient(135deg, #ffc990 0%, #ffa854 100%);
    }

    .btn-reset {
      background: linear-gradient(135deg, #ffb3ba 0%, #ff8a95 100%);
      color: white;
      border: 2px solid rgba(255, 255, 255, 0.3);
    }

    .btn-reset:hover {
      background: linear-gradient(135deg, #ffa3aa 0%, #ff7882 100%);
    }

    .btn-apply {
      background: linear-gradient(135deg, #ffd4a3 0%, #ffb366 100%);
      color: white;
      width: 100%;
      border: 2px solid rgba(255, 255, 255, 0.3);
    }

    .btn-apply:hover {
      background: linear-gradient(135deg, #ffc990 0%, #ffa854 100%);
    }

    /* ========================================
       統計表示
       ======================================== */
    .stats {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      padding: 25px;
      background: linear-gradient(135deg, #fff9f0 0%, #fff0e1 100%);
      border-radius: 25px;
      border: 2px solid #ffe8d6;
      box-shadow: 0 4px 15px rgba(255, 150, 50, 0.08);
    }

    .stat-item {
      text-align: center;
      padding: 15px;
      background: white;
      border-radius: 18px;
      transition: all 0.3s ease;
    }

    .stat-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 20px rgba(255, 150, 50, 0.12);
    }

    .stat-label {
      font-size: 13px;
      color: #a07856;
      margin-bottom: 8px;
      font-weight: 600;
      letter-spacing: 0.5px;
    }

    .stat-value {
      font-size: 32px;
      font-weight: 800;
      background: linear-gradient(135deg, #ffb366, #ff9944);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* ========================================
       通知
       ======================================== */
    .notification {
      position: fixed;
      top: 25px;
      right: 25px;
      background: white;
      padding: 20px 30px;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(255, 150, 50, 0.25);
      transform: translateX(500px);
      transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 1000;
      border-left: 5px solid #a8e6a1;
      max-width: 350px;
      font-weight: 600;
      color: #5a5a5a;
      border: 2px solid #ffe8d6;
    }

    .notification.show {
      transform: translateX(0);
    }

    .notification.error {
      border-left-color: #ffb3ba;
    }

    /* ========================================
       キーボードヘルプ
       ======================================== */
    .keyboard-help {
      text-align: center;
      margin-top: 25px;
      padding-top: 25px;
      border-top: 2px solid #ffe8d6;
      font-size: 13px;
      color: #a07856;
      font-weight: 500;
    }

    .keyboard-help kbd {
      background: linear-gradient(135deg, #ffd4a3, #ffb366);
      color: white;
      padding: 4px 10px;
      border-radius: 8px;
      font-weight: 700;
      margin: 0 3px;
      box-shadow: 0 2px 8px rgba(255, 150, 50, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    /* ========================================
       レスポンシブ
       ======================================== */
    @media (max-width: 600px) {
      .container {
        padding: 30px 20px;
      }

      .presets {
        grid-template-columns: 1fr;
      }

      .timer-text {
        font-size: 60px;
      }

      .controls {
        flex-direction: column;
      }

      .btn {
        width: 100%;
      }

      .stats {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- メインコンテナ -->
  <div class="container">
    <!-- タイトル -->
    <h1 class="title">勉強タイマー</h1>

    <!-- プリセット選択 -->
    <div class="presets">
      <button class="preset-btn active" data-preset="pomodoro">
        <div class="preset-title">Pomodoro</div>
        <div class="preset-time">25分</div>
      </button>
      <button class="preset-btn" data-preset="short">
        <div class="preset-title">短め</div>
        <div class="preset-time">15分</div>
      </button>
      <button class="preset-btn" data-preset="custom">
        <div class="preset-title">カスタム</div>
        <div class="preset-time">自由設定</div>
      </button>
    </div>

    <!-- カスタム設定 -->
    <div class="custom-settings" id="customSettings">
      <div class="custom-title">時間を設定してください</div>
      <div class="input-row">
        <div class="input-group">
          <label for="customMinutes">分</label>
          <input type="number" id="customMinutes" min="0" max="99" value="25">
        </div>
        <div class="input-group">
          <label for="customSeconds">秒</label>
          <input type="number" id="customSeconds" min="0" max="59" value="0">
        </div>
      </div>
      <button class="btn btn-apply" id="applyCustomBtn">設定を適用</button>
    </div>

    <!-- タイマー表示 -->
    <div class="timer-display">
      <div class="timer-text" id="timerText">25:00</div>
      <div class="timer-label" id="timerLabel">集中時間</div>
    </div>

    <!-- プログレスバー -->
    <div class="progress-container">
      <div class="progress-bar" id="progressBar"></div>
    </div>

    <!-- コントロールボタン -->
    <div class="controls">
      <button class="btn btn-start" id="startBtn">スタート</button>
      <button class="btn btn-reset" id="resetBtn">リセット</button>
    </div>

    <!-- 統計 -->
    <div class="stats">
      <div class="stat-item">
        <div class="stat-label">今日の完了</div>
        <div class="stat-value" id="todayCount">0</div>
      </div>
      <div class="stat-item">
        <div class="stat-label">合計時間</div>
        <div class="stat-value" id="totalTime">0分</div>
      </div>
    </div>

    <!-- キーボードヘルプ -->
    <div class="keyboard-help">
      <kbd>Space</kbd> スタート/停止
      <kbd>R</kbd> リセット
      <kbd>1</kbd> <kbd>2</kbd> <kbd>3</kbd> プリセット選択
    </div>
  </div>

  <!-- 通知 -->
  <div class="notification" id="notification"></div>

  <script>
    // ========================================
    // アプリケーション全体の状態管理
    // ========================================
    const AppState = {
      // 現在選択されているプリセット
      currentPreset: 'pomodoro',
      
      // 現在のモード（work: 作業中, break: 休憩中）
      currentMode: 'work',
      
      // 残り時間（秒）
      remainingTime: 0,
      
      // 初期設定時間（秒）
      initialTime: 0,
      
      // タイマーが動作中かどうか
      isRunning: false,
      
      // setIntervalのID
      intervalId: null,
      
      // カスタム設定
      customWork: 25 * 60,
      customBreak: 5 * 60
    };

    // ========================================
    // プリセット設定
    // ========================================
    const PRESETS = {
      pomodoro: {
        work: 25 * 60,  // 25分 = 1500秒
        break: 5 * 60   // 5分 = 300秒
      },
      short: {
        work: 15 * 60,  // 15分 = 900秒
        break: 5 * 60   // 5分 = 300秒
      },
      custom: {
        work: 25 * 60,  // デフォルト25分
        break: 5 * 60   // デフォルト5分
      }
    };

    // ========================================
    // DOM要素の取得
    // ========================================
    const DOM = {
      presetBtns: document.querySelectorAll('.preset-btn'),
      customSettings: document.getElementById('customSettings'),
      customMinutes: document.getElementById('customMinutes'),
      customSeconds: document.getElementById('customSeconds'),
      applyCustomBtn: document.getElementById('applyCustomBtn'),
      timerText: document.getElementById('timerText'),
      timerLabel: document.getElementById('timerLabel'),
      progressBar: document.getElementById('progressBar'),
      startBtn: document.getElementById('startBtn'),
      resetBtn: document.getElementById('resetBtn'),
      todayCount: document.getElementById('todayCount'),
      totalTime: document.getElementById('totalTime'),
      notification: document.getElementById('notification')
    };

    // ========================================
    // ローカルストレージの操作
    // ========================================
    const Storage = {
      // 設定を保存
      saveSettings: function() {
        try {
          const data = {
            preset: AppState.currentPreset,
            customWork: AppState.customWork,
            customBreak: AppState.customBreak
          };
          localStorage.setItem('timerSettings', JSON.stringify(data));
        } catch (e) {
          console.error('設定の保存に失敗:', e);
        }
      },

      // 設定を読み込み
      loadSettings: function() {
        try {
          const saved = localStorage.getItem('timerSettings');
          if (saved) {
            const data = JSON.parse(saved);
            AppState.currentPreset = data.preset || 'pomodoro';
            AppState.customWork = data.customWork || 25 * 60;
            AppState.customBreak = data.customBreak || 5 * 60;
            PRESETS.custom.work = AppState.customWork;
            PRESETS.custom.break = AppState.customBreak;
          }
        } catch (e) {
          console.error('設定の読み込みに失敗:', e);
        }
      },

      // 統計を保存
      saveStats: function(completedMinutes) {
        try {
          const stats = JSON.parse(localStorage.getItem('timerStats') || '{}');
          const today = new Date().toDateString();
          
          if (!stats[today]) {
            stats[today] = { count: 0, totalMinutes: 0 };
          }
          
          stats[today].count += 1;
          stats[today].totalMinutes += completedMinutes;
          
          localStorage.setItem('timerStats', JSON.stringify(stats));
          this.updateStatsDisplay();
        } catch (e) {
          console.error('統計の保存に失敗:', e);
        }
      },

      // 統計を読み込んで表示
      updateStatsDisplay: function() {
        try {
          const stats = JSON.parse(localStorage.getItem('timerStats') || '{}');
          const today = new Date().toDateString();
          const todayStats = stats[today] || { count: 0, totalMinutes: 0 };
          
          DOM.todayCount.textContent = todayStats.count;
          DOM.totalTime.textContent = todayStats.totalMinutes + '分';
        } catch (e) {
          console.error('統計の読み込みに失敗:', e);
        }
      }
    };

    // ========================================
    // タイマー表示の更新
    // ========================================
    const Display = {
      // タイマーテキストを更新
      updateTimer: function() {
        const minutes = Math.floor(AppState.remainingTime / 60);
        const seconds = AppState.remainingTime % 60;
        DOM.timerText.textContent = 
          String(minutes).padStart(2, '0') + ':' + 
          String(seconds).padStart(2, '0');
      },

      // プログレスバーを更新
      updateProgress: function() {
        const progress = (AppState.remainingTime / AppState.initialTime) * 100;
        DOM.progressBar.style.width = progress + '%';
      },

      // ラベルを更新
      updateLabel: function() {
        DOM.timerLabel.textContent = 
          AppState.currentMode === 'work' ? '集中時間' : '休憩時間';
      },

      // すべての表示を更新
      updateAll: function() {
        this.updateTimer();
        this.updateProgress();
        this.updateLabel();
      }
    };

    // ========================================
    // プリセット選択
    // ========================================
    const PresetManager = {
      // プリセットを選択
      select: function(presetName) {
        // ボタンの見た目を更新
        DOM.presetBtns.forEach(btn => {
          if (btn.dataset.preset === presetName) {
            btn.classList.add('active');
          } else {
            btn.classList.remove('active');
          }
        });

        // カスタム設定パネルの表示切替
        if (presetName === 'custom') {
          DOM.customSettings.classList.add('show');
        } else {
          DOM.customSettings.classList.remove('show');
        }

        // 状態を更新
        AppState.currentPreset = presetName;
        AppState.currentMode = 'work';
        
        // タイマーをリセット
        Timer.reset();
        
        // 設定を保存
        Storage.saveSettings();
      }
    };

    // ========================================
    // カスタム設定
    // ========================================
    const CustomSettings = {
      // カスタム設定を適用
      apply: function() {
        const minutes = parseInt(DOM.customMinutes.value) || 0;
        const seconds = parseInt(DOM.customSeconds.value) || 0;
        const totalSeconds = minutes * 60 + seconds;

        if (totalSeconds <= 0) {
          Notification.show('0より大きい値を設定してください', 'error');
          return;
        }

        // カスタム設定を更新
        AppState.customWork = totalSeconds;
        PRESETS.custom.work = totalSeconds;
        
        // タイマーをリセット
        Timer.reset();
        
        // 設定を保存
        Storage.saveSettings();
        
        // 通知
        Notification.show('カスタム設定を適用しました');
      }
    };

    // ========================================
    // タイマーのコア機能
    // ========================================
    const Timer = {
      // タイマーを開始
      start: function() {
        if (AppState.isRunning) {
          this.pause();
          return;
        }

        AppState.isRunning = true;
        DOM.startBtn.textContent = '一時停止';
        DOM.startBtn.classList.remove('btn-start');
        DOM.startBtn.classList.add('btn-pause');

        // 1秒ごとに実行
        AppState.intervalId = setInterval(() => {
          AppState.remainingTime--;
          Display.updateAll();

          // 時間切れ
          if (AppState.remainingTime <= 0) {
            this.complete();
          }
        }, 1000);
      },

      // タイマーを一時停止
      pause: function() {
        AppState.isRunning = false;
        DOM.startBtn.textContent = 'スタート';
        DOM.startBtn.classList.remove('btn-pause');
        DOM.startBtn.classList.add('btn-start');
        clearInterval(AppState.intervalId);
      },

      // タイマーをリセット
      reset: function() {
        this.pause();
        
        // 現在のプリセットから時間を取得
        const preset = PRESETS[AppState.currentPreset];
        const duration = preset[AppState.currentMode];
        
        AppState.remainingTime = duration;
        AppState.initialTime = duration;
        
        Display.updateAll();
      },

      // タイマー完了
      complete: function() {
        this.pause();
        
        // アラーム音を再生
        Sound.playAlarm();
        
        // 作業完了の場合
        if (AppState.currentMode === 'work') {
          const completedMinutes = Math.floor(AppState.initialTime / 60);
          Storage.saveStats(completedMinutes);
          Notification.show('お疲れ様でした！休憩しましょう');
          AppState.currentMode = 'break';
        } 
        // 休憩完了の場合
        else {
          Notification.show('休憩終了！また頑張りましょう');
          AppState.currentMode = 'work';
        }
        
        // 次のモードの時間を設定
        const preset = PRESETS[AppState.currentPreset];
        AppState.remainingTime = preset[AppState.currentMode];
        AppState.initialTime = preset[AppState.currentMode];
        
        Display.updateAll();
      }
    };

    // ========================================
    // 音声再生
    // ========================================
    const Sound = {
      // アラーム音を再生（3回のビープ音）
      playAlarm: function() {
        try {
          const AudioContextClass = window.AudioContext || window.webkitAudioContext;
          const audioContext = new AudioContextClass();
          
          // 3回ビープ音を鳴らす
          for (let i = 0; i < 3; i++) {
            setTimeout(function() {
              const oscillator = audioContext.createOscillator();
              const gainNode = audioContext.createGain();
              
              oscillator.connect(gainNode);
              gainNode.connect(audioContext.destination);
              
              // 高めの音（800Hz）
              oscillator.frequency.value = 800;
              oscillator.type = 'sine';
              
              // 音量設定
              gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
              gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
              
              oscillator.start(audioContext.currentTime);
              oscillator.stop(audioContext.currentTime + 0.5);
            }, i * 600);
          }
        } catch (e) {
          console.error('音声再生エラー:', e);
        }
      }
    };

    // ========================================
    // 通知表示
    // ========================================
    const Notification = {
      show: function(message, type = 'success') {
        DOM.notification.textContent = message;
        DOM.notification.classList.remove('error');
        
        if (type === 'error') {
          DOM.notification.classList.add('error');
        }
        
        DOM.notification.classList.add('show');
        
        setTimeout(() => {
          DOM.notification.classList.remove('show');
        }, 3000);
      }
    };

    // ========================================
    // キーボード操作
    // ========================================
    const Keyboard = {
      handle: function(event) {
        // 入力フィールドにフォーカスがある場合は無効
        if (event.target.tagName === 'INPUT') {
          return;
        }

        switch(event.key.toLowerCase()) {
          case ' ':
            event.preventDefault();
            Timer.start();
            break;
          case 'r':
            Timer.reset();
            break;
          case '1':
            PresetManager.select('pomodoro');
            break;
          case '2':
            PresetManager.select('short');
            break;
          case '3':
            PresetManager.select('custom');
            break;
        }
      }
    };

    // ========================================
    // イベントリスナーの設定
    // ========================================
    const EventListeners = {
      setup: function() {
        // プリセットボタン
        DOM.presetBtns.forEach(btn => {
          btn.addEventListener('click', () => {
            PresetManager.select(btn.dataset.preset);
          });
        });

        // カスタム設定適用ボタン
        DOM.applyCustomBtn.addEventListener('click', () => {
          CustomSettings.apply();
        });

        // スタートボタン
        DOM.startBtn.addEventListener('click', () => {
          Timer.start();
        });

        // リセットボタン
        DOM.resetBtn.addEventListener('click', () => {
          Timer.reset();
        });

        // キーボード操作
        document.addEventListener('keydown', (e) => {
          Keyboard.handle(e);
        });

        // Enterキーでカスタム設定を適用
        DOM.customMinutes.addEventListener('keydown', (e) => {
          if (e.key === 'Enter') {
            CustomSettings.apply();
          }
        });
        
        DOM.customSeconds.addEventListener('keydown', (e) => {
          if (e.key === 'Enter') {
            CustomSettings.apply();
          }
        });
      }
    };

    // ========================================
    // 初期化
    // ========================================
    function init() {
      // 保存された設定を読み込み
      Storage.loadSettings();
      
      // プリセットを選択
      PresetManager.select(AppState.currentPreset);
      
      // 統計を表示
      Storage.updateStatsDisplay();
      
      // イベントリスナーを設定
      EventListeners.setup();
    }

    // アプリケーション起動
    init();
  </script>
</body>
</html>
<!--
========================================
使い方
========================================
1. このHTMLファイルをブラウザで開くだけで動作します
2. プリセット（Pomodoro / 短め / カスタム）を選択
3. カスタムを選ぶと時間設定パネルが表示されます
4. スタートボタンでタイマー開始、一時停止ボタンで停止
5. リセットボタンで初期状態に戻ります
6. タイマー終了時に3回のビープ音が鳴ります

キーボードショートカット:
- Space: スタート/一時停止
- R: リセット
- 1/2/3: プリセット選択

========================================
コード構造
========================================
このコードは以下の原則で書かれています:

1. **明確な責任分離**
   - AppState: アプリケーションの状態を一元管理
   - PRESETS: プリセット設定の定義
   - DOM: DOM要素への参照を一箇所にまとめる
   - Storage: ローカルストレージ操作
   - Display: 画面表示の更新
   - Timer: タイマーのコア機能
   - Sound: 音声再生
   - など、機能ごとにオブジェクトで分離

2. **後から修正しやすい設計**
   - 各機能が独立しているため、一部だけ修正可能
   - 定数（PRESETS）を変更するだけで動作が変わる
   - 関数名が機能を明確に表現している

3. **コメントによる説明**
   - 各セクションに説明コメントを追加
   - 複雑な処理には詳細なコメント

修正方法の例:
- タイマーの初期値を変更 → PRESTSオブジェクトを編集
- アラーム音を変更 → Sound.playAlarm関数を編集
- 色を変更 → CSSの該当部分を編集
-->
